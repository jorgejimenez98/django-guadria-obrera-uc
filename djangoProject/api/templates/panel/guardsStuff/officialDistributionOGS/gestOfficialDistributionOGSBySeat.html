{% extends 'panel/master.html' %}
{% load static %}

{% block headerBlock %}
    <title>GOE | Panel | Distribución Oficial OGS</title>
{% endblock %}

{% block mainBlock %}
    <div class="content  d-flex flex-column flex-column-fluid" id="kt_content"
         style="background: url('{% static 'public/images/footer-bg.jpg' %}') repeat fixed; background-size: 100% 100%; border-top-left-radius: 90% !important;">
        <!--begin::Subheader-->
        <div class="subheader py-2 py-lg-6  subheader-transparent " id="kt_subheader">
            <div class=" container  d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap">
                <!--begin::Info-->
                <div class="d-flex align-items-center flex-wrap mr-1">

                    <!--begin::Page Heading-->
                    <div class="d-flex align-items-baseline flex-wrap mr-5">
                        <!--begin::Page Title-->
                        <ul class="breadcrumb breadcrumb-transparent breadcrumb-dot font-weight-bold p-0 my-2 font-size-sm">
                            <li class="breadcrumb-item">
                                <a href="/panel/officialDistributionOGS/" class="text-muted">
                                    Volver a la sección anterior (Distribución de OGS por Sedes Universitarias)
                                </a>
                            </li>
                        </ul>
                        <!--end::Page Title-->
                    </div>
                    <!--end::Page Heading-->
                    <div class="d-flex align-items-center flex-wrap mr-1">

                        <!--begin::Page Heading-->
                    </div>
                </div>
                <!--end::Info-->

                <!--begin::Toolbar-->
                <div class="d-flex align-items-center">
                    <a href="#" class="btn btn-bg-white font-weight-bold mr-3 my-2 my-lg-0" data-toggle="tooltip">
                        <span class="text-muted font-weight-bold mr-2"
                              id="kt_dashboard_daterangepicker_title">Día de Hoy</span>
                        <span class="text-primary font-weight-bolder"
                              id="kt_dashboard_daterangepicker_date">{{ today }}</span>
                    </a>
                </div>
                <!--end::Toolbar-->
            </div>
        </div>
        <!--end::Subheader-->

        <div class="d-flex flex-column-fluid">
            <!--begin::Container-->
            <div class=" container ">
                <!--begin::Card-->
                <div class="card card-custom" style="box-shadow: 0 0 10px 5px #1BC5BD;">
                    <div class="card-header flex-wrap border-0 pt-6 pb-0">
                        <div class="card-title">
                            <h3 class="card-label">
                                Tabla de Gestión de los Oficiales de Guardia de la
                                <strong>Sede {{ universitySeat.name }}</strong>
                                <span class="text-muted pt-2 font-size-sm d-block">
                                    Se gestiona un OGS para cada día del mes
                                </span>
                            </h3>
                        </div>
                        <div class="card-toolbar">
                            <!--begin::Dropdown-->
                            <div class="dropdown dropdown-inline mr-2">
                                <button type="button" class="btn btn-light-primary font-weight-bolder dropdown-toggle"
                                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <span class="svg-icon svg-icon-md"><!--begin::Svg Icon | path:assets/media/svg/icons/Design/PenAndRuller.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect x="0" y="0" width="24" height="24"></rect><path d="M3,16 L5,16 C5.55228475,16 6,15.5522847 6,15 C6,14.4477153 5.55228475,14 5,14 L3,14 L3,12 L5,12 C5.55228475,12 6,11.5522847 6,11 C6,10.4477153 5.55228475,10 5,10 L3,10 L3,8 L5,8 C5.55228475,8 6,7.55228475 6,7 C6,6.44771525 5.55228475,6 5,6 L3,6 L3,4 C3,3.44771525 3.44771525,3 4,3 L10,3 C10.5522847,3 11,3.44771525 11,4 L11,19 C11,19.5522847 10.5522847,20 10,20 L4,20 C3.44771525,20 3,19.5522847 3,19 L3,16 Z" fill="#000000" opacity="0.3"></path><path d="M16,3 L19,3 C20.1045695,3 21,3.8954305 21,5 L21,15.2485298 C21,15.7329761 20.8241635,16.200956 20.5051534,16.565539 L17.8762883,19.5699562 C17.6944473,19.7777745 17.378566,19.7988332 17.1707477,19.6169922 C17.1540423,19.602375 17.1383289,19.5866616 17.1237117,19.5699562 L14.4948466,16.565539 C14.1758365,16.200956 14,15.7329761 14,15.2485298 L14,5 C14,3.8954305 14.8954305,3 16,3 Z" fill="#000000"></path></g></svg><!--end::Svg Icon--></span>
                                    Acciones
                                </button>

                                <!--begin::Dropdown Menu-->
                                <div class="dropdown-menu dropdown-menu-sm dropdown-menu-right" style="">
                                    <!--begin::Navigation-->
                                    <ul class="navi flex-column navi-hover py-2">
                                        <li class="navi-header font-weight-bolder text-uppercase font-size-sm text-primary pb-2">
                                            Elige una Opción:
                                        </li>
                                        <li class="navi-item">
                                            <a href="{% url 'exportToExcel' universitySeat=universitySeat.name fileType='csv' %}"
                                               class="navi-link">
                                                <span class="navi-icon"><i class="la la-file-excel-o"></i></span>
                                                <span class="navi-text">Excel (csv)</span>
                                            </a>
                                        </li>
                                        <li class="navi-item">
                                            <a href="{% url 'exportToExcel' universitySeat=universitySeat.name fileType='xlsx' %}"
                                               class="navi-link">
                                                <span class="navi-icon"><i class="la la-file-excel-o"></i></span>
                                                <span class="navi-text">Excel (xlsx)</span>
                                            </a>
                                        </li>
                                        <li class="navi-item">
                                            <a href="{% url 'publishOGSReport' universitySeatId=universitySeat.pk %}"
                                               class="navi-link">
                                                <span class="navi-icon"><i class="la la-file-excel-o"></i></span>
                                                <span class="navi-text">
                                                    {% if universitySeat.isOfficialDistributionOGSPublished %}
                                                        Quitar Reporte de la Página Principal
                                                    {% else %}
                                                        Generar Reporte
                                                    {% endif %}
                                                </span>
                                            </a>
                                        </li>
                                    </ul>
                                    <!--end::Navigation-->
                                </div>
                                <!--end::Dropdown Menu-->
                            </div>
                            <!--end::Dropdown-->
                        </div>
                    </div>
                    <div class="card-body">
                        <!--begin: Datatable-->
                          {% if messages %}
                             {% for message in messages %}
                                    <div class="alert alert-custom
                                                {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %} alert-light-danger
                                                {% elif message.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %} alert-light-success
                                                {% endif %} fade show mb-5 animated bounce"
                                        role="alert" style="box-shadow: 0 0 2px 2px darkgrey;">
                                    <div class="alert-icon">
                                        <i class="{% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}
                                                      flaticon-danger
                                                  {% elif message.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %}
                                                      flaticon2-check-mark
                                                  {% endif %}"></i>
                                    </div>
                                    <div class="alert-text">
                                        <h3 class="font-weight-bold"><strong>{{ message }}</strong></h3>
                                    </div>
                                    <div class="alert-close">
                                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                            <span aria-hidden="true"><i class="ki ki-close"></i></span>
                                        </button>
                                    </div>
                                </div>
                             {% endfor %}
                        {% endif %}


                        <div class="datatable datatable-bordered datatable-head-custom datatable-default datatable-primary datatable-loaded"
                             id="kt_datatable" style="">
                            <table class="datatable-table table-responsive" style="display: block;">
                                <thead class="datatable-head">
                                <tr class="datatable-row" style="left: 0px;">
                                    <th class="datatable-cell datatable-cell-sort datatable-cell-sorted text-center">
                                        <span style="width: 110px;">Día del Mes</span>
                                    </th>
                                    <th class="datatable-cell datatable-cell-sort datatable-cell-sorted text-center">
                                        <span style="width: 110px">Oficial de Guardia</span>
                                    </th>
                                    <th class="datatable-cell datatable-cell-sort datatable-cell-sorted text-center">
                                        <span style="width: 110px;">Facultad</span>
                                    </th>
                                    <th class="datatable-cell datatable-cell-sort datatable-cell-sorted text-center">
                                        <span style="width: 110px;">Área</span>
                                    </th>
                                    <th class="datatable-cell datatable-cell-sort datatable-cell-sorted text-center float-right">
                                        <span style="width: 110px;">Acciones</span>
                                    </th>
                                </tr>
                                </thead>
                                <tbody class="datatable-body" style="">
                                    {% for i in officialDistributions %}
                                        <tr data-row="0" class="datatable-row" style="left: 0px;">
                                            <td class="datatable-cell-sorted datatable-cell text-center" aria-label="1">
                                                <div style="width: 110px;">
                                                    <span class="{% if todayDay == i.dayOfMonth %} badge badge-primary {% else %} badge badge-danger {% endif %}">
                                                        <strong>{{ i.dayOfMonth }}</strong>
                                                    </span>
                                                </div>
                                            </td>
                                            <td class="datatable-cell float-left text-center">
                                                {% if i.hasGuardOfficer %}
                                                    <span style="width: 110px;">{{ i.guardOfficer.names }} {{ i.guardOfficer.surnames }}</span>
                                                {% else %}
                                                    <span style="width: 110px;">
                                                        <span class="label font-weight-bold label-lg  label-light-danger label-inline float-right">
                                                            No Registrada
                                                        </span>
                                                    </span>
                                                {% endif %}
                                            </td>
                                            <td class="datatable-cell text-center">
                                                {% if i.hasFaculty %}
                                                    <span style="width: 110px;">{{ i.faculty.name }}</span>
                                                {% else %}
                                                    <span style="width: 110px;">
                                                        <span class="label font-weight-bold label-lg  label-light-danger label-inline float-right">
                                                            No Registrada
                                                        </span>
                                                    </span>
                                                {% endif %}
                                            </td>
                                            <td class="datatable-cell text-center">
                                                {% if i.hasArea %}
                                                    <span style="width: 110px;">{{ i.area.name }}</span>
                                                {% else %}
                                                    <span style="width: 110px;">
                                                        <span class="label font-weight-bold label-lg  label-light-danger label-inline">
                                                            No Registrada
                                                        </span>
                                                    </span>
                                                {% endif %}
                                            </td>

                                            <td class="datatable-cell text-center">
                                                <div style="width: 110px;" class="float-right">
                                                    <a href="{% url 'editOfficialOGSDistributionBySeatAndDayOfMonth' universitySeat=universitySeat.name day=i.dayOfMonth %}"
                                                       data-toggle="tooltip"
                                                       title="Editar" data-placement="left"
                                                       class="btn btn-light-primary font-weight-bolder btn-sm mr-2 ">
                                                        <i class="flaticon2-edit"></i>
                                                    </a>
                                                </div>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        <!--end: Datatable-->
                    </div>
                </div>
                <!--end::Card-->
            </div>
            <!--end::Container-->
        </div>

    </div>

{% endblock %}

{% block footerBlock %}

{% endblock %}

